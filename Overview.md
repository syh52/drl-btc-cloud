# 🎯 DRL-BTC-Cloud 项目概述

## 项目简介

**DRL-BTC-Cloud** 是一个基于深度强化学习(PPO)的比特币自动交易系统，构建在Google Cloud Platform上，实现从训练到部署的完整MLOps闭环。本项目采用MVP(最小可行产品)方法，专注于验证DRL交易策略的可行性。

### 核心理念
- 🤖 **AI优先**: 使用PPO强化学习算法自主学习交易策略
- ☁️ **云原生**: 完全基于GCP服务构建，具备高可用性和弹性
- 📊 **数据驱动**: 基于历史价格数据和技术指标进行决策
- 🛡️ **风险可控**: 仅进行纸面交易，确保资金安全

## 项目架构

### 系统设计
```
┌─────────────────────────────────────────────────────────────┐
│                     Google Cloud Platform                   │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐    ┌───────────────┐    ┌──────────────┐   │
│  │ Vertex AI   │───▶│  GCS Storage  │◀───│ Cloud Run    │   │
│  │ (PPO训练)   │    │  (模型/数据)   │    │ (推理服务)    │   │
│  └─────────────┘    └───────────────┘    └──────────────┘   │
│                             ▲                     ▲         │
│  ┌─────────────┐            │                     │         │
│  │Cloud        │    ┌───────────────┐    ┌──────────────┐   │
│  │Scheduler    │───▶│   Pub/Sub     │───▶│  Eventarc    │   │
│  │(每分钟)     │    │   (消息队列)   │    │  (触发器)    │   │
│  └─────────────┘    └───────────────┘    └──────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

### 技术栈

#### 🧠 机器学习框架
- **Stable-Baselines3**: PPO强化学习算法实现
- **Gymnasium**: 标准化的强化学习环境接口
- **PyTorch**: 深层神经网络后端
- **Numpy/Pandas**: 数据处理和数值计算

#### ☁️ 云服务架构
- **Vertex AI**: 大规模模型训练平台
- **Cloud Run**: 无服务器容器化推理服务
- **Cloud Storage**: 模型存储和数据管理
- **Cloud Scheduler**: 定时触发交易决策
- **Pub/Sub**: 异步消息队列
- **Eventarc**: 事件驱动架构

#### 🌐 Web服务技术
- **FastAPI**: 高性能异步Web框架
- **Uvicorn**: ASGI服务器
- **Docker**: 容器化部署
- **Cloud Logging**: 分布式日志系统

#### 📈 金融数据处理
- **CCXT**: 加密货币交易所API统一接口
- **Python-dateutil**: 时间序列处理
- **Pytz**: 时区管理

## 项目结构

```
drl-btc-cloud/
├── 🎓 train/                    # 模型训练模块
│   ├── btc_env.py               # BTC交易环境(Gymnasium标准)
│   ├── train.py                 # PPO训练脚本
│   └── submit_job.py            # Vertex AI任务提交
├── 🚀 app/                      # 推理服务模块
│   ├── main.py                  # 完整FastAPI应用
│   ├── main_simple.py           # 简化版API服务
│   ├── Dockerfile               # 容器化配置
│   ├── requirements.txt         # 推理服务依赖
│   └── train/                   # 复制的训练代码(用于推理)
├── 🏗️ infra/                    # 基础设施代码
│   └── deploy.sh                # 一键部署脚本
├── 📋 requirements.txt          # 完整项目依赖
├── ⚙️ config.yaml               # 统一配置文件
├── 🛠️ Makefile                  # 自动化命令集
├── 📚 README.md                 # 详细使用指南
├── ✅ VERIFICATION.md           # 项目验收清单
└── 📖 Overview.md               # 本概述文档
```

## 核心功能

### 1. 🎯 强化学习交易环境
- **观测空间**: `[lookback × features]` 历史价格和技术指标矩阵
- **动作空间**: `[-1, 1]` 连续目标持仓比例(-1=空仓, 1=满仓)
- **奖励函数**: `持仓收益 - 交易手续费 - 风险惩罚`
- **特征工程**: OHLCV价格 + 收益率 + 移动平均比率

### 2. 🧠 PPO算法训练
- **算法优势**: 稳定的策略梯度方法，适合连续动作空间
- **网络结构**: MLP多层感知机(适合MVP阶段)
- **训练参数**: 100K步训练，64批次大小，0.0003学习率
- **模型管理**: 自动保存到GCS，支持版本控制

### 3. 🌐 实时推理服务
- **API接口**: RESTful API，支持健康检查和交易决策
- **数据获取**: 支持模拟数据和真实交易所数据
- **模型加载**: 动态从GCS加载最新训练模型
- **日志记录**: 完整的决策日志和性能监控

### 4. ⏰ 自动化交易循环
- **定时触发**: Cloud Scheduler每分钟触发一次
- **消息队列**: Pub/Sub确保可靠的消息传递
- **事件驱动**: Eventarc自动调用推理服务
- **纸面交易**: 记录所有决策但不执行真实交易

## 部署和运维

### 🚀 一键部署
```bash
# 克隆项目
git clone <repository-url>
cd drl-btc-cloud

# 安装依赖
make install

# 一键部署到GCP
make deploy
```

### 📊 监控和管理
- **实时日志**: Cloud Logging集中日志管理
- **服务监控**: Cloud Run内置监控指标
- **成本控制**: 按请求计费，无流量无费用
- **API测试**: 内置健康检查和状态接口

## 性能指标

### 🎯 系统性能
- **训练时间**: 10-30分钟(100K步，CPU环境)
- **推理延迟**: < 200ms(不含冷启动)
- **触发频率**: 每分钟1次交易决策
- **数据存储**: 约1MB/天的决策日志

### 💰 成本估算(每月)
- **Vertex AI训练**: $5-10(偶尔重训练)
- **Cloud Run服务**: $5-15(按请求计费)
- **GCS存储**: $1-3(模型和日志)
- **其他服务**: $1-2(Pub/Sub, Scheduler等)
- **总计**: **约$12-30/月**

## MVP范围

### ✅ 当前支持
- **单一交易对**: BTCUSDT
- **CPU训练**: 快速验证，成本可控
- **纸面交易**: 完全模拟，零风险
- **MLP网络**: 简单有效的神经网络

### 🔮 未来扩展
- **多币种支持**: ETH, BNB等主流币种
- **GPU加速**: 更复杂的模型和更快训练
- **实盘连接**: Binance等交易所API集成
- **LSTM网络**: 更好的时序建模能力

## 开发指南

### 🛠️ 本地开发
```bash
# 环境检查
make smoke-test

# 本地训练
make train

# API服务测试
cd app && python main.py
```

### 🧪 测试和验证
- **环境测试**: Gymnasium标准检查
- **模型验证**: 训练收敛性检查
- **API测试**: FastAPI自动文档和测试
- **端到端测试**: 完整交易决策流程

## 安全和风险管理

### 🛡️ 安全措施
- **仅纸面交易**: 不连接真实资金账户
- **GCP权限控制**: 最小权限原则
- **日志加密**: 敏感信息加密存储
- **容器隔离**: Cloud Run安全沙箱

### ⚠️ 风险提示
- **教育目的**: 本项目仅用于学习和研究
- **不构成投资建议**: 所有决策结果仅供参考
- **高风险警告**: 加密货币交易具有极高风险
- **谨慎使用**: 真实交易前请充分测试和验证

## 项目价值

### 🎓 学习价值
- **强化学习实践**: 完整的RL项目从理论到实践
- **云原生架构**: 现代MLOps最佳实践
- **金融科技**: 量化交易和风险管理
- **自动化运维**: DevOps和基础设施即代码

### 💼 商业潜力
- **策略验证平台**: 快速验证交易策略有效性
- **教育培训**: 金融科技和AI教育工具
- **研究基础**: 可扩展为更复杂的交易系统
- **技术展示**: 展示AI和云计算能力

---

> **📞 联系方式**  
> 如有任何问题或建议，请通过以下方式联系：
> - 📧 Email: [your.email@example.com]
> - 🐙 GitHub: [项目仓库链接]
> - 📝 Issues: [问题反馈链接]

---

*最后更新: 2024年8月*